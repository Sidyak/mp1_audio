//------------------------------------------- 
// Header File including MPEG1-Layer I LuT Tables 
// Source: MPEG ISO CD 11172-3
// http://ecee.colorado.edu/~fmeyer/class/ecen4532/mpeg1-layerIII.pdf
//
// Copyright (C) 2022 Kim Radmacher
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
// express or implied.
// See the License for the specific language governing permissions
// and limitations under the License.
//----------------------------------------------------------------------------

//------------------------------------------- 
// Scalefactors
//------------------------------------------- 
#ifndef MPEG_TABLES_H_//INIT_H_
#define MPEG_TABLES_H_

float table_scf[63] = {   // represented by 6 bits 2^6=64
   2.00000000000000, 1.58740105196820, 1.25992104989487, 1.00000000000000,
   0.79370052598410, 0.62996052494744, 0.50000000000000, 0.39685026299205,
   0.31498026247372, 0.25000000000000, 0.19842513149602, 0.15749013123686,
   0.12500000000000, 0.09921256574801, 0.07874506561843, 0.06250000000000,
   0.04960628287401, 0.03937253280921, 0.03125000000000, 0.02480314143700,
   0.01968626640461, 0.01562500000000, 0.01240157071850, 0.00984313320230,
   0.00781250000000, 0.00620078535925, 0.00492156660115, 0.00390625000000,
   0.00310039267963, 0.00246078330058, 0.00195312500000, 0.00155019633981,
   0.00123039165029, 0.00097656250000, 0.00077509816991, 0.00061519582514,
   0.00048828125000, 0.00038754908495, 0.00030759791257, 0.00024414062500,
   0.00019377454248, 0.00015379895629, 0.00012207031250, 0.00009688727124,
   0.00007689947814, 0.00006103515625, 0.00004844363562, 0.00003844973907,
   0.00003051757813, 0.00002422181781, 0.00001922486954, 0.00001525878906,
   0.00001211090890, 0.00000961243477, 0.00000762939453, 0.00000605545445,
   0.00000480621738, 0.00000381469727, 0.00000302772723, 0.00000240310869,
   0.00000190734863, 0.00000151386361, 0.00000120155435
};
//-------------------------------------------
// TH in quiet LTq and corresponding bark indices
// for Bitrates more than 96 kbps
// designed with -- get_LTq.m
//-------------------------------------------
/*if(BITRATE >= 96){

 */
    //-------------------------------------------
    // TH in quiet and coresponding bark indices
    // designed with -- get_LTq.m
    //-------------------------------------------
    /* Threshold in quiet */
    float LTq_dB[102]={
        12.17,1.87,-1.99,-4.06,-5.38,-6.30,-7.00,-7.55,-8.00,-8.39,-8.74,-9.07,-9.37,-9.68,-9.98,-10.29,-10.62,-10.96,-11.33,-11.71,-12.11,-12.54,-12.97,-13.43,-13.88,-14.34,-14.79,-15.22,-15.62,-15.98,-16.30,-16.57,-16.77,-16.91,-16.98,-16.97,-16.90,-16.76,-16.55,-16.29,-15.99,-15.64,-15.26,-14.86,-14.45,-14.04,-13.63,-13.24,-12.51,-11.88,-11.36,-10.94,-10.61,-10.34,-10.12,-9.92,-9.73,-9.54,-9.35,-9.14,-8.91,-8.67,-8.40,-8.11,-7.80,-7.46,-7.09,-6.69,-6.27,-5.82,-5.33,-4.81,-3.67,-2.37,-0.92,0.71,2.53,4.54,6.77,9.23,11.94,14.90,18.14,21.67,25.51,29.67,34.17,39.04,44.29,49.94,56.00,56.00,56.00,56.00,56.00,56.00,56.00,56.00,56.00,56.00,56.00,56.00
    };
    /* Threshold in quiet ENTLOG! */
    float LTq[102]={
        16.4816239152551,1.53815464030303,0.632411851376220,0.392644935399600,0.289734358770132,0.234422881531992,0.199526231496888,0.175792361395869,0.158489319246111,0.144877185354476,0.133659551654644,0.123879658653037,0.115611224219210,0.107646521362984,0.100461579027840,0.0935405674147552,0.0866961875758217,0.0801678063387679,0.0736207097494736,0.0674528027697922,0.0615176872709868,0.0557185748931930,0.0504661297563528,0.0453941616650203,0.0409260659730011,0.0368128973642531,0.0331894457552610,0.0300607630262823,0.0274157417192788,0.0252348077248057,0.0234422881531992,0.0220292646305346,0.0210377843976648,0.0203704207770572,0.0200447202736516,0.0200909281260873,0.0204173794466953,0.0210862814993329,0.0221309470960564,0.0234963282084831,0.0251767692775886,0.0272897778280804,0.0297851642942919,0.0326587832172336,0.0358921934645005,0.0394457302075279,0.0433510878387529,0.0474241985260245,0.0561047976032471,0.0648634433548238,0.0731139083483418,0.0805378441199067,0.0868960429286302,0.0924698173938223,0.0972747223776965,0.101859138805412,0.106414301822432,0.111173172728159,0.116144861384034,0.121898959892487,0.128528665994362,0.135831344658715,0.144543977074593,0.154525443953841,0.165958690743756,0.179473362683253,0.195433945577540,0.214289060112006,0.236047823318058,0.261818300821899,0.293089324525032,0.330369541036815,0.429536426764887,0.579428696426881,0.809095899178382,1.17760597352081,1.79060585403529,2.84446110744792,4.75335225942805,8.37529282126883,15.6314764264095,30.9029543251359,65.1628394060843,146.892627764387,355.631318568986,926.829823379349,2612.16135439921,8016.78063387679,26853.4444565851,98627.9485631210,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497,398107.170553497
    };

/*}else{ // for Bitrates lower than 96 kbps!!
    // Threshold in quiet
    float LTq_dB[102]={
        24.17,13.87,10.01,7.94,6.62,5.70,5.00,4.45,4.00,3.61,3.26,2.93,2.63,2.32,2.02,1.71,1.38,1.04,0.67,0.29,-0.11,-0.54,-0.97,-1.43,-1.88,-2.34,-2.79,-3.22,-3.62,-3.98,-4.30,-4.57,-4.77,-4.91,-4.98,-4.97,-4.90,-4.76,-4.55,-4.29,-3.99,-3.64,-3.26,-2.86,-2.45,-2.04,-1.63,-1.24,-0.51,0.12,0.64,1.06,1.39,1.66,1.88,2.08,2.27,2.46,2.65,2.86,3.09,3.33,3.60,3.89,4.20,4.54,4.91,5.31,5.73,6.18,6.67,7.19,8.33,9.63,11.08,12.71,14.53,16.54,18.77,21.23,23.94,26.90,30.14,33.67,37.51,41.67,46.17,51.04,56.29,61.94,68.00,68.00,68.00,68.00,68.00,68.00,68.00,68.00,68.00,68.00,68.00,68.00
    };
}
*/
/* Frequency indices corresponds to 0...20250 Hz */
short LTq_f[102]={
    1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216
};      
/* 24 Barkbands upsampled to 102 indices*/
float LTq_B[102]={
    0.925,1.842,2.742,3.618,4.463,5.272,6.041,6.770,7.457,8.103,8.708,9.275,9.805,10.301,10.765,11.199,11.606,11.988,12.347,12.684,13.002,13.302,13.586,13.855,14.111,14.354,14.585,14.807,15.018,15.221,15.415,15.602,15.783,15.956,16.124,16.287,16.445,16.598,16.746,16.891,17.032,17.169,17.303,17.434,17.563,17.688,17.811,17.932,18.166,18.392,18.611,18.823,19.028,19.226,19.419,19.606,19.788,19.964,20.135,20.300,20.461,20.616,20.766,20.912,21.052,21.188,21.318,21.445,21.567,21.684,21.797,21.906,22.113,22.304,22.482,22.646,22.799,22.941,23.072,23.195,23.309,23.415,23.515,23.607,23.694,23.775,23.852,23.923,23.991,24.054,24.114,24.171,24.224,24.275,24.322,24.368,24.411,24.452,24.491,24.528,24.564,24.597 
};      
/* Mappe Frequenzbereich der Indices von k (0:255)auf Indices (0:101), die bis k=215 bzw. bis 20250 Hz gehen durch das Subsampling (jeder 2. und jeder 4.) */
short Map[256]={
    1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59,60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,72,72,73,73,73,73,74,74,74,74,75,75,75,75,76,76,76,76,77,77,77,77,78,78,78,78,79,79,79,79,80,80,80,80,81,81,81,81,82,82,82,82,83,83,83,83,84,84,84,84,85,85,85,85,86,86,86,86,87,87,87,87,88,88,88,88,89,89,89,89,90,90,90,90,91,91,91,91,92,92,92,92,93,93,93,93,94,94,94,94,95,95,95,95,96,96,96,96,97,97,97,97,98,98,98,98,99,99,99,99,100,100,100,100,101,101,101,101,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102
}; 

//------------------------------------------- 
// Critical band boundary table [ISO table 3-D.2c] 
// designed with -- get_crit_band_bound.m 
//------------------------------------------- 
/* Critical band indices */
short CB_i[26]={
    1,2,3,4,5,6,7,9,10,12,14,16,19,21,25,29,35,41,49,53,58,65,73,79,89,102 
}; 
/* Crit. band frequencys up to 20250 Hz */
short CB_f[26]={
    1,2,3,4,5,6,7,9,10,12,14,16,19,21,25,29,35,41,50,58,68,82,100,124,164,216 
}; 

//------------------------------------------- 
// TABLE 3-C.2 LAYER I SIGNAL-TO-NOISE RATIOS 
// designed with -- get_SNR.m 
//------------------------------------------- 
/* ISO Bit_leng */
short Bit_leng[15]={
    0,2,3,4,5,6,7,8,9,10,11,12,13,14,15 
}; 
/* No of resulation steps */
short No_steps[15]={
    0,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767 
}; 
/* SNR/dB */
float SNR[15]={
    0.00,7.00,16.00,25.28,31.59,37.75,43.84,49.89,55.93,61.96,67.98,74.01,80.03,86.05,92.01 
}; 

float quantization_table[14][3]={
    { 3,       0.750000000, -0.250000000 },       // 2 Bit
    { 7 ,      0.875000000, -0.125000000 },       // 3 Bit
    { 15,      0.937500000, -0.062500000 },       // 4 Bit
    { 31 ,     0.968750000, -0.031250000 },       // 5 Bit
    { 63 ,     0.984375000, -0.015625000 },       // 6 Bit
    { 127 ,    0.992187500, -0.007812500 },       // 7 Bit
    { 255 ,    0.996093750, -0.003906250 },       // 8 Bit
    { 511 ,    0.998046875, -0.001953125 },       // 9 Bit
    { 1023 ,   0.999023438, -0.000976563 },       // 10 Bit
    { 2047 ,   0.999511719, -0.000488281 },       // 11 Bit
    { 4095 ,   0.999755859, -0.000244141 },       // 12 Bit
    { 8191  ,  0.999877930, -0.000122070 },       // 13 Bit
    { 16383 ,  0.999938965, -0.000061035 },       // 14 Bit
    { 32767 ,  0.999969482, -0.000030518 },       // 15 Bit
};


#endif /* MPEG_TABLES_H_ */
